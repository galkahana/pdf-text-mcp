# Claude Session Data - PDF Text MCP Project

## Project Context
- **Project**: PDF Text Extraction MCP Service
- **Current Phase**: Complete and Production-Ready ✅
- **Repository**: https://github.com/galkahana/pdf-text-mcp
- **Location**: `/Users/galk/Documents/projects/hummus_ai/pdf-text-mcp`
- **Status**: All development phases complete, ready for public use

## Git Workflow
**Standard Process**:
1. Create feature branch from main: `git checkout -b phase-N-description`
2. Make changes and commit with descriptive messages
3. Push branch to remote: `git push -u origin phase-N-description`
4. Open Pull Request (PR) with comprehensive description
5. Merge PR to main after review/approval
6. Delete feature branch

## Architecture

### Packages
- **pdf-parser**: Native C++ addon for PDF text/metadata extraction
- **mcp-server**: MCP protocol server (stdio and HTTP transports)

### Key Design Patterns

**Stream-Based Core Functions (DRY Principle)**:
- Core functions work with `IByteReaderWithPosition` streams
- File/buffer operations are thin wrappers creating appropriate streams
- Single source of truth for extraction logic

**Worker Architecture**:
- `ICancellable` interface for type-safe cancellation
- `CancellableAsyncWorker<T>` template base class
- Specialized base classes: `TextExtractionBaseWorker`, `MetadataExtractionBaseWorker`
- Worker implementations in `native/workers/` folder
- Client bindings (`napi_bindings`, `pdf_extractor_addon`) at root

## Features

### PDF Parser
- ✅ Text extraction from files and buffers
- ✅ Metadata extraction (title, author, dates, etc.)
- ✅ Automatic RTL/LTR text direction detection
  - Multi-signal analysis (alignment variance, content analysis, script detection)
  - Supports Hebrew, Arabic, and other bidirectional scripts
- ✅ True async cancellation with N-API workers
- ✅ Timeout support with atomic flags
- ✅ Thread-safe buffer operations
- ✅ Zero-copy stream architecture

### MCP Server
- ✅ MCP protocol support (stdio and HTTP transports)
- ✅ Docker containerization
- ✅ Kubernetes deployment with Helm
- ✅ Observability (Prometheus metrics, Grafana dashboards, Loki logging)
- ✅ Development tooling (Justfile, linting, formatting)
- ✅ Comprehensive testing (91 tests total)

## Build Requirements
- Node.js >= 18.0.0
- C++17 compiler
- CMake >= 3.15
- ICU library (bidirectional text support)

## Dependencies
- **pdf-text-extraction v1.1.10**: Fetched via CMake FetchContent
- **@modelcontextprotocol/sdk**: MCP protocol implementation
- All dependencies managed via npm and CMake

## Test Coverage
- **pdf-parser**: 50 tests (unit + integration)
- **mcp-server**: 41 tests (unit + mocked integration)
- **Manual integration**: Full end-to-end protocol tests
- ✅ All tests passing
